#version 330
#define SAMPLES 5

in vec2 uv;

uniform sampler2D u_texture;
uniform float screen_width;
uniform float screen_height;
uniform float radius;
/*
const float gaussian[289] = float[289]
    (
        0.0000062043903237073,0.00003899379803773442,0.00019173887715532776,0.0007377235541417433,0.0022212173750332655,0.005234163182906674,0.009654042591895607,0.013938443947109972,0.015753590477992373,0.013938443947109972,0.009654042591895607,0.005234163182906674,0.0022212173750332655,0.0007377235541417433,0.00019173887715532776,0.00003899379803773442,0.0000062043903237073,0.00003899379803773442,0.00024507102327164175,0.001205054269910814,0.0046364979920692495,0.013960066533692807,0.032896044800877794,0.060674420440254506,0.08760133387435297,0.09900929719408007,0.08760133387435297,0.060674420440254506,0.032896044800877794,0.013960066533692807,0.0046364979920692495,0.001205054269910814,0.00024507102327164175,0.00003899379803773442,0.00019173887715532776,0.001205054269910814,0.005925448770092602,0.022798418304162228,0.06864392844199707,0.16175522802031048,0.2983460404653774,0.4307500741046899,0.48684489398955816,0.4307500741046899,0.2983460404653774,0.16175522802031048,0.06864392844199707,0.022798418304162228,0.005925448770092602,0.001205054269910814,0.00019173887715532776,0.0007377235541417433,0.0046364979920692495,0.022798418304162228,0.08771789232150198,0.264110459035691,0.6223601780012602,1.14789918769543,1.6573293863502807,1.8731566119414789,1.6573293863502807,1.14789918769543,0.6223601780012602,0.264110459035691,0.08771789232150198,0.022798418304162228,0.0046364979920692495,0.0007377235541417433,0.0022212173750332655,0.013960066533692807,0.06864392844199707,0.264110459035691,0.795212159411915,1.8738689216903965,3.4562182624926265,4.990065463474622,5.639901273646251,4.990065463474622,3.4562182624926265,1.8738689216903965,0.795212159411915,0.264110459035691,0.06864392844199707,0.013960066533692807,0.0022212173750332655,0.005234163182906674,0.032896044800877794,0.16175522802031048,0.6223601780012602,1.8738689216903965,4.4156577513526845,8.14436740184317,11.758784719942968,13.290083146997516,11.758784719942968,8.14436740184317,4.4156577513526845,1.8738689216903965,0.6223601780012602,0.16175522802031048,0.032896044800877794,0.005234163182906674,0.009654042591895607,0.060674420440254506,0.2983460404653774,1.14789918769543,3.4562182624926265,8.14436740184317,15.02170777522013,21.688244051309848,24.51261534412037,21.688244051309848,15.02170777522013,8.14436740184317,3.4562182624926265,1.14789918769543,0.2983460404653774,0.060674420440254506,0.009654042591895607,0.013938443947109972,0.08760133387435297,0.4307500741046899,1.6573293863502807,4.990065463474622,11.758784719942968,21.688244051309848,31.313345797148152,35.39115471252565,31.313345797148152,21.688244051309848,11.758784719942968,4.990065463474622,1.6573293863502807,0.4307500741046899,0.08760133387435297,0.013938443947109972,0.015753590477992373,0.09900929719408007,0.48684489398955816,1.8731566119414789,5.639901273646251,13.290083146997516,24.51261534412037,35.39115471252565,40,35.39115471252565,24.51261534412037,13.290083146997516,5.639901273646251,1.8731566119414789,0.48684489398955816,0.09900929719408007,0.015753590477992373,0.013938443947109972,0.08760133387435297,0.4307500741046899,1.6573293863502807,4.990065463474622,11.758784719942968,21.688244051309848,31.313345797148152,35.39115471252565,31.313345797148152,21.688244051309848,11.758784719942968,4.990065463474622,1.6573293863502807,0.4307500741046899,0.08760133387435297,0.013938443947109972,0.009654042591895607,0.060674420440254506,0.2983460404653774,1.14789918769543,3.4562182624926265,8.14436740184317,15.02170777522013,21.688244051309848,24.51261534412037,21.688244051309848,15.02170777522013,8.14436740184317,3.4562182624926265,1.14789918769543,0.2983460404653774,0.060674420440254506,0.009654042591895607,0.005234163182906674,0.032896044800877794,0.16175522802031048,0.6223601780012602,1.8738689216903965,4.4156577513526845,8.14436740184317,11.758784719942968,13.290083146997516,11.758784719942968,8.14436740184317,4.4156577513526845,1.8738689216903965,0.6223601780012602,0.16175522802031048,0.032896044800877794,0.005234163182906674,0.0022212173750332655,0.013960066533692807,0.06864392844199707,0.264110459035691,0.795212159411915,1.8738689216903965,3.4562182624926265,4.990065463474622,5.639901273646251,4.990065463474622,3.4562182624926265,1.8738689216903965,0.795212159411915,0.264110459035691,0.06864392844199707,0.013960066533692807,0.0022212173750332655,0.0007377235541417433,0.0046364979920692495,0.022798418304162228,0.08771789232150198,0.264110459035691,0.6223601780012602,1.14789918769543,1.6573293863502807,1.8731566119414789,1.6573293863502807,1.14789918769543,0.6223601780012602,0.264110459035691,0.08771789232150198,0.022798418304162228,0.0046364979920692495,0.0007377235541417433,0.00019173887715532776,0.001205054269910814,0.005925448770092602,0.022798418304162228,0.06864392844199707,0.16175522802031048,0.2983460404653774,0.4307500741046899,0.48684489398955816,0.4307500741046899,0.2983460404653774,0.16175522802031048,0.06864392844199707,0.022798418304162228,0.005925448770092602,0.001205054269910814,0.00019173887715532776,0.00003899379803773442,0.00024507102327164175,0.001205054269910814,0.0046364979920692495,0.013960066533692807,0.032896044800877794,0.060674420440254506,0.08760133387435297,0.09900929719408007,0.08760133387435297,0.060674420440254506,0.032896044800877794,0.013960066533692807,0.0046364979920692495,0.001205054269910814,0.00024507102327164175,0.00003899379803773442,0.0000062043903237073,0.00003899379803773442,0.00019173887715532776,0.0007377235541417433,0.0022212173750332655,0.005234163182906674,0.009654042591895607,0.013938443947109972,0.015753590477992373,0.013938443947109972,0.009654042591895607,0.005234163182906674,0.0022212173750332655,0.0007377235541417433,0.00019173887715532776,0.00003899379803773442,0.0000062043903237073
    )
;
*/
const int samples = 17;

void main() {
    vec4 sum = vec4(0.0);

    // Number of pixels off the central pixel to sample from
    float horizontal_blur = radius / screen_width;
    float vertical_blur = horizontal_blur; //radius / screen_height;

    for (int i = 0; i < samples; i++) {
        float horizontal_offset = -1 * float(samples) / 2 + i;
        for (int j = 0; j < samples; j++) {
            float vertical_offset = -1 * float(samples) / 2 + j;
            sum += texture(u_texture, vec2(uv.x + horizontal_offset * horizontal_blur, uv.y + vertical_offset * vertical_blur)) * 0.022798418304162224;
        }
    }

    gl_FragColor = vec4(sum.xyz * 1.05, sum.a * 0.4);
}

